## 2026-01-12 - Todo cleanup (PRD #1, #2, #3)

Removed todo example code from entire codebase:
- Deleted backend router (apps/backend/src/routers/todo/)
- Deleted frontend components, queries, mutations
- Deleted DB schema, types, relations
- Updated index route to redirect to /dashboard

Note: db:push not run - table still exists in DB but code is clean. Run manually if needed.

Next: PRD #4-7 (pockets cleanup, multi-step demo removal)

## 2026-01-12 - Pockets cleanup backend+frontend (PRD #4, #5)

Removed pockets feature from backend and frontend:
- Deleted backend router (apps/backend/src/routers/pocket/)
- Deleted frontend components, queries, mutations, route
- Removed pockets key from query keys
- Removed Pockets link from navbar and mobile-nav
- Regenerated router types

Note: PRD #6 still pending - pockets DB schema and balance calculation refs remain. Do #6 next to complete pockets removal.

## 2026-01-12 - Pockets DB + balance cleanup (PRD #6)

Removed pockets from database schema and balance calculations:
- Deleted packages/db/src/schemas/pockets.ts
- Removed pockets export from schemas/index.ts
- Removed pocket types from types.ts
- Removed pockets from SnapshotData type in snapshots.ts
- Removed pockets relation from relations.ts
- Removed calcPocketsTotal and pockets from balance service
- Removed pockets from snapshot service archival
- Removed pockets section from dashboard-overview.tsx

Note: db:push requires interactive confirmation to drop tables. Run manually if needed.

Next: PRD #7 (remove multi-step form demo route)

## 2026-01-13 - Tags DB schema (PRD #8)

Created tags database schema:
- Created packages/db/src/schemas/tags.ts with id, userId, name, color fields
- Exported tags from schemas/index.ts
- Added Tag, TagInsert, TagUpdate types + zod schemas to types.ts

Note: db:push not run - requires interactive confirmation. Run manually.

Next: PRD #9 (add tagId to expenses) or PRD #10 (tags API endpoints)

## 2026-01-13 - Add tagId to expenses (PRD #9)

Added nullable tagId foreign key to expenses schema:
- Added import for tags table in expenses.ts
- Added tagId field with onDelete: 'set null' (tag deletion doesn't delete expenses)
- Types auto-updated via Drizzle inference (no manual changes needed)

Note: db:push not run - requires interactive confirmation. Run manually.

Next: PRD #10 (tags API endpoints)

## 2026-01-13 - Tags API endpoints (PRD #10)

Created tags CRUD API:
- Created apps/backend/src/routers/tag/service.ts with getUserTags, getTag, createTag, updateTag, deleteTag
- Created apps/backend/src/routers/tag/controller.ts with GET /tags, POST /tags, PATCH /tags/:id, DELETE /tags/:id
- Registered tagsRouter in backend index.ts
- All routes require auth, ownership check on update/delete

Next: PRD #11 (tags queries/mutations frontend)

## 2026-01-13 - Remove multi-step demo (PRD #7)

Removed multi-step form demo from codebase:
- Deleted apps/web/src/routes/multi.tsx
- Deleted apps/web/src/components/multi-step-demo/ folder (multi.tsx, step-1.tsx, step-2.tsx)
- Regenerated router types

Next: PRD #10 (tags API endpoints)

## 2026-01-13 - Tags queries and mutations (PRD #11)

Created frontend tags queries and mutations:
- Created apps/web/src/lib/queries/tags.queries.ts with tagListOptions
- Created apps/web/src/lib/mutations/tags.mutations.ts with create, update, delete options
- Added tags key to apps/web/src/lib/queries/keys.ts

Next: PRD #12 (tag management UI)

## 2026-01-13 - Tag management UI (PRD #12)

Created full tag management UI for expenses:
- apps/web/src/lib/constants/tag-colors.ts - 12 preset colors
- apps/web/src/components/tag/color-picker.tsx - reusable color picker
- apps/web/src/components/tag/tag-badge.tsx - tag display (dot + name)
- apps/web/src/components/tag/add-tag-dialog.tsx - create new tags
- apps/web/src/components/tag/manage-tags-dialog.tsx - list/edit/delete tags
- apps/web/src/components/tag/tag-selector.tsx - dropdown for expense forms
- Updated expense-fields.tsx with tagId field + TagSelector

Tag selector has "No tag", tag list, "Create tag", "Manage tags" options.

Next: PRD #13 (mock email service)

## 2026-01-13 - Mock email service (PRD #13)

Implemented dev mode email mocking:
- Modified packages/email/src/index.ts to check NODE_ENV
- In dev: console.log emails with formatted output (ðŸ“§ [DEV] prefix)
- In prod: uses Resend as before
- Added sendInvitation function with to, inviterName, householdName, token params
- Email text in French, contains link to /invite/:token with 7-day expiry note

Next: PRD #14 (send invitation email when creating invitation)

## 2026-01-13 - Send invitation email (PRD #14)

Integrated email sending when creating household invitations:
- Imported mail from @repo/email in invitation controller
- Added @repo/email as backend dependency
- After invitation creation, calls mail.sendInvitation with:
  - to: invitee email
  - inviterName: from relation or fallback to user.email
  - householdName: from relation or fallback to 'Foyer'
  - token: for invite link

In dev mode, email is logged to console. In prod, sent via Resend.

Next: PRD #15 (consolidate routes into single dashboard)

## 2026-01-14 - Route consolidation (PRD #15)

Consolidated all separate routes into single dashboard at root:
- Deleted apps/web/src/routes/expenses.tsx
- Deleted apps/web/src/routes/incomes.tsx
- Deleted apps/web/src/routes/household.tsx
- Deleted apps/web/src/routes/dashboard.tsx
- Transformed index.tsx to render DashboardOverview directly (was redirecting to /dashboard)
- Updated navbar.tsx: removed Dashboard/Incomes/Expenses/Household links, kept Admin for admins
- Updated mobile-nav.tsx: removed same links, kept Admin + Account
- Updated household-badge.tsx: now links to "/" instead of "/household"
- Regenerated router types

Next: PRD #16-20 (dashboard tabs, personal/household tab content, dialogs, nav cleanup)

## 2026-01-14 - Dashboard tabs (PRD #16)

Created dashboard tabs component with URL-persisted tab state:
- Added shadcn Tabs component (bunx shadcn@latest add tabs)
- Created apps/web/src/components/dashboard/dashboard-tabs.tsx
  - Two tabs: "Personnel" and "Foyer" with icons (Home, Users)
  - Tab state persisted via URL search param (?tab=personnel|foyer)
  - Uses TanStack Router validateSearch for typed search params
- Updated index.tsx route:
  - Added search schema validation (zod)
  - DashboardTabs wraps DashboardOverview (personal) and HouseholdSettings (foyer)
- Regenerated router types

Next: PRD #17-20 (personal/household tab content enhancements, dialogs, nav cleanup)

## 2026-01-15 - Household tab enhancements (PRD #17, #18, #20, #26)

Enhanced household tab with shared expenses and user share display:
- Updated household-settings.tsx with two-column grid layout
- Added ShareCard showing user's monthly household share (violet styling)
- Added shared expenses section with AddHouseholdExpenseForm + HouseholdExpenseList
- All text in French (Foyer, Ma part ce mois, Membres, DÃ©penses partagÃ©es)

Also marked as complete (already implemented):
- PRD #17: personal-tab.tsx had all features (insight cards, income/expense lists, month nav)
- PRD #20: Navigation cleanup done in PRD #15 (navbar/mobile-nav simplified)
- PRD #26: InsightCard component in personal-tab.tsx has all required variants

Next: PRD #19 (modal dialogs), PRD #21-25 (French i18n), PRD #27-32 (stats/charts)

## 2026-01-15 - Modal dialogs for CRUD (PRD #19)

Created modal dialogs for adding incomes and expenses:
- Created apps/web/src/components/income/add-income-dialog.tsx
- Created apps/web/src/components/expense/add-expense-dialog.tsx
- Updated personal-tab.tsx to use dialogs instead of embedded forms
- Removed AddIncomeForm/AddExpenseForm inline usage, now uses button triggers
- Edit dialogs already in use (EditIncomeDialog, EditExpenseDialog) via item components

All forms now work via modals. French labels (Ajouter, Ajouter un revenu, Ajouter une dÃ©pense).

Next: PRD #21-25 (French i18n), PRD #27-32 (stats/charts)

## 2026-01-15 - French formatters (PRD #21)

Updated number/date formatters to French locale:
- Changed format-currency.ts from en-US to fr-FR locale (outputs "1 234,56 â‚¬")
- Created format-date.ts with French date formatting:
  - formatDate: "12 janvier 2024"
  - formatDateShort: "12 janv. 2024"
  - formatMonthYear: "janvier 2024"
  - formatMonth: "janvier"

Next: PRD #22-25 (translate UI strings), PRD #27-32 (stats/charts)

## 2026-01-15 - Stats API endpoints (PRD #27)

Created stats API for charts:
- Created apps/backend/src/routers/stats/service.ts with:
  - getExpensesByTag(userId, year, month) - groups personal expenses by tag, returns tag name/color/total
  - getMonthlyTrend(userId, monthsBack) - returns expense totals for last N months
- Created apps/backend/src/routers/stats/controller.ts with GET routes:
  - GET /stats/expenses-by-tag?year=&month= - expenses grouped by tag for pie chart
  - GET /stats/monthly-trend?monthsBack= - monthly expense totals for trend chart
- Registered statsRouter in backend index.ts

Both endpoints reuse expense calculation logic from balance service (toMonthlyAmount, isActiveInMonth).

Next: PRD #28 (stats queries frontend), PRD #29-32 (charts UI)

## 2026-01-16 - Stats queries frontend (PRD #28)

Created frontend stats queries for chart data fetching:
- Created apps/web/src/lib/queries/stats.queries.ts with:
  - expensesByTagOptions(year, month) - fetches expenses grouped by tag for pie chart
  - monthlyTrendOptions(monthsBack) - fetches monthly expense totals for trend chart
- Added stats key to keys.ts with byTag and trend query keys

Next: PRD #29 (install shadcn charts), PRD #30-32 (chart components)

## 2026-01-16 - Install shadcn charts (PRD #29)

Installed shadcn charts component for data visualization:
- Ran bunx shadcn@latest add chart in apps/web
- Verified recharts 2.15.4 installed as dependency
- Updated chart.tsx + card.tsx generated by shadcn
- Fixed biome lint issues in generated files

Next: PRD #30-32 (chart components), PRD #22-25 (French i18n)

## 2026-01-16 - Spending pie chart (PRD #30)

Created spending by category pie chart:
- Created apps/web/src/components/dashboard/spending-pie-chart.tsx
- Donut chart (inner radius) with Recharts PieChart via shadcn ChartContainer
- Fetches data from expensesByTagOptions(year, month)
- Uses tag colors for slices, slate for untagged ("Sans tag")
- Custom tooltip with tag color dot + formatted EUR amount
- Legend below chart with tag names + amounts
- Empty state when no expenses
- Integrated into personal-tab.tsx, replacing placeholder

Next: PRD #31-32 (trend chart, income vs expenses chart), PRD #22-25 (French i18n)

## 2026-01-16 - Spending trend chart (PRD #31)

Created spending trend bar chart:
- Created apps/web/src/components/dashboard/spending-trend-chart.tsx
- Bar chart with Recharts BarChart via shadcn ChartContainer
- Fetches data from monthlyTrendOptions(6) - last 6 months
- X-axis: French month names (abbreviated), Y-axis: EUR amounts
- Slate color bars with rounded top corners
- Custom tooltip with full month name + formatted amount
- Loading/empty states matching pie chart style
- Integrated into personal-tab.tsx in 2-column grid with pie chart

Next: PRD #32 (income vs expenses chart), PRD #22-25 (French i18n)

## 2026-01-16 - Income vs expenses chart (PRD #32)

Created income vs expenses bar chart:
- Created apps/web/src/components/dashboard/income-vs-expenses-chart.tsx
- Bar chart with 3 bars: Revenus (green), DÃ©penses perso (slate), Part foyer (violet)
- Uses recharts BarChart via shadcn ChartContainer
- Tooltip with colored dots + formatted EUR amounts
- Legend below chart with amounts
- Empty state when no data
- Takes income/personalExpenses/householdShare as props from balance data
- Integrated into personal-tab.tsx below existing charts grid

Next: PRD #22-25 (French i18n), PRD #33 (styling)

## 2026-01-17 - Dashboard French i18n (PRD #22)

Translated all dashboard components to French:
- balance-item.tsx: "ending soon" â†’ "fin proche"
- dashboard-overview.tsx: Already had most translations, verified all complete:
  - Month locale fr-FR, "ArchivÃ©", "Projection", "Ã‰chec du chargement des donnÃ©es"
  - "Aucune donnÃ©e archivÃ©e pour ce mois", "DÃ©ficit de ... ce mois-ci"
  - "Revenus", "DÃ©penses personnelles", "Part du foyer", "Solde"
- dashboard-tabs.tsx: "Personnel" and "Foyer" already French
- Charts (pie, trend, income-vs-expenses): Already French (done with chart PRDs)
- personal-tab.tsx: Already French (done with earlier PRDs)

Next: PRD #23-25 (expense/income/household/auth French i18n), PRD #33 (styling)

## 2026-01-17 - Expense/income French i18n (PRD #23)

Translated all expense and income components to French:
- expense-fields.tsx: Type (Ponctuel/RÃ©current), Period (Quotidien/Hebdomadaire/Mensuel/Annuel), all labels, validation
- expense-item.tsx: Delete dialog (Supprimer/Annuler), "on" â†’ "le"
- expense-list-card.tsx: "Expenses" â†’ "DÃ©penses", login message
- edit-expense-dialog.tsx: "Edit Expense" â†’ "Modifier la dÃ©pense", "Save" â†’ "Enregistrer"
- add-expense-form.tsx: "Add Expense" â†’ "Ajouter une dÃ©pense"
- income-fields.tsx: Period labels, all field labels, validation messages
- income-item.tsx: Period abbreviations (/jour, /sem, /mois, /an), fr-FR locale for amounts
- income-list-card.tsx: "Incomes" â†’ "Revenus", login message
- edit-income-dialog.tsx: "Edit Income" â†’ "Modifier le revenu", "Save" â†’ "Enregistrer"
- add-income-form.tsx: "Add Income" â†’ "Ajouter un revenu"

Next: PRD #24-25 (household/auth French i18n), PRD #33 (styling)

## 2026-01-17 - Household French i18n (PRD #24)

Translated all household and household-expense components to French:
- member-item.tsx: "(you)" â†’ "(vous)"
- invite-form.tsx: "Invite Member" â†’ "Inviter un membre", "Send Invite" â†’ "Envoyer l'invitation"
- leave-household-button.tsx: "Leave Household" â†’ "Quitter le foyer", dialog in French
- create-household-form.tsx: "Create Household" â†’ "CrÃ©er le foyer", all labels/errors
- pending-invitation-item.tsx: "Expired" â†’ "ExpirÃ©", "days left" â†’ "jours restants"
- pending-invitations.tsx: "Pending Invitations" â†’ "Invitations en attente"
- member-list.tsx: "Members" â†’ "Membres"
- split-mode-toggle.tsx: "Split Mode" â†’ "Mode de partage", mode labels/descriptions
- household-expense-card.tsx: "Household Expenses" â†’ "DÃ©penses du foyer"
- edit-household-expense-dialog.tsx: "Edit Household Expense" â†’ "Modifier la dÃ©pense du foyer"
- add-household-expense-form.tsx: "Add Expense" â†’ "Ajouter une dÃ©pense"
- household-expense-item.tsx: "Disabled" â†’ "DÃ©sactivÃ©", delete dialog in French

Next: PRD #25 (auth/nav French i18n), PRD #33 (styling)

## 2026-01-17 - Auth/nav French i18n (PRD #25)

Translated all auth and navigation components to French:
- login-form.tsx: "Sign in" â†’ "Se connecter", "Password" â†’ "Mot de passe", validation msgs
- register-form.tsx: "Create account" â†’ "CrÃ©er un compte", "Name" â†’ "Nom", validation msgs
- navbar.tsx: "Login" â†’ "Connexion", "Register" â†’ "Inscription"
- mobile-nav.tsx: "Account" â†’ "Compte"
- user-menu.tsx: "Account" â†’ "Compte", "Logout" â†’ "DÃ©connexion"
- logout-button.tsx: "Logout" â†’ "DÃ©connexion"
- invite.$token.tsx: All invitation UI text, accept/decline buttons, error messages
- account.tsx: All profile/email/password form labels, success/error messages
  - "Account Settings" â†’ "ParamÃ¨tres du compte"
  - Profile/Email/Password sections fully translated

Next: PRD #33 (styling), PRD #34 (end-to-end testing)
